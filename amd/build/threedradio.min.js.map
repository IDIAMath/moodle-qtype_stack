{"version":3,"sources":["../src/threedradio.js"],"names":["threedradio","inputid","exp","slice","length","option","document","getElementById","parentNode","style","width","height","paddingBottom","margin","display","createCanvas","element","expression","mathbox","mathBox","plugins","controls","klass","THREE","OrbitControls","fallback","three","renderer","setClearColor","Color","graphData","view","resolution","xMin","xMax","yMin","yMax","zMin","zMax","updateGraphFunc","zFunc","Parser","parse","toJSFunction","set","emit","x","y","zSmallest","zBiggest","z","graphColors","camera","proxy","position","cartesian","range","scale","xAxis","axis","detail","color","xScale","divide","nice","zero","xTicks","ticks","size","zBias","xFormat","format","digits","font","weight","source","xTicksLabel","label","zIndex","offset","points","text","yAxis","yScale","yTicks","yFormat","yTicksLabel","zAxis","zScale","zTicks","zFormat","zTicksLabel","grid","axes","divideX","divideY","opacity","area","channels","expr","graphViewSolid","surface","shaded","fill","lineX","lineY","colors","visible","graphViewWire"],"mappings":"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","sourcesContent":["/**\r\n *\r\n * @param inputid The ID of the input sibling-node where the canvas will be placed\r\n * @param exp The code element containing the expression\r\n */\r\nexport const threedradio = (inputid, exp) => {\r\n    // Remove code tags\r\n    exp = exp.slice(6, exp.length-7);\r\n\r\n    // Get the option node where the input and canvas are placed\r\n    let option = document.getElementById(inputid).parentNode;\r\n    option.style.width = '80%';\r\n    option.style.height = 0;\r\n    option.style.paddingBottom = '50%';\r\n    option.style.margin = '10px';\r\n    option.style.display = 'inline-flex';\r\n\r\n    createCanvas(option, exp);\r\n\r\n}\r\n\r\n/**\r\n *\r\n * @param element The element the mathbox canvas should be placed\r\n * @param expression The mathmatical expression to render\r\n */\r\nconst createCanvas = (element, expression) => {\r\n    var mathbox = mathBox({\r\n        plugins: ['core', 'controls', 'cursor', 'mathbox'],\r\n        controls: {klass: THREE.OrbitControls},\r\n        element: element\r\n    });\r\n    if (mathbox.fallback) throw \"WebGL not supported\"\r\n\r\n    var three = mathbox.three;\r\n    three.renderer.setClearColor(new THREE.Color(0xFFFFFF), 1.0);\r\n\r\n    var graphData, view;\r\n\r\n    // THe nxn resolution of the render\r\n    var resolution = 64;\r\n\r\n    var functionText = expression;\r\n\r\n    var\txMin = -3, xMax = 3, yMin = -3,\tyMax = 3, zMin = 0, zMax = 3;\r\n\r\n    var zAutofit = true;\r\n\r\n    // start of updateGraph function ==============================================================\r\n    var updateGraphFunc = function()\r\n    {\r\n        var zFunc = Parser.parse( functionText ).toJSFunction( ['x','y'] );\r\n        graphData.set(\"expr\",\r\n            function (emit, x, y, i, j, t)\r\n            {\r\n                emit( x, zFunc(x,y), y );\r\n            }\r\n        );\r\n\r\n        if (zAutofit)\r\n        {\r\n            var xStep = (xMax - xMin) / 256;\r\n            var yStep = (yMax - yMin) / 256;\r\n            var zSmallest = zFunc(xMin, yMin);\r\n            var zBiggest  = zFunc(xMin, yMin);\r\n            for (var x = xMin; x <= xMax; x += xStep)\r\n            {\r\n                for (var y = yMin; y <= yMax; y += yStep)\r\n                {\r\n                    var z = zFunc(x,y);\r\n                    if (z < zSmallest) zSmallest = z;\r\n                    if (z > zBiggest)  zBiggest  = z;\r\n                }\r\n            }\r\n            zMin = zSmallest;\r\n            zMax = zBiggest;\r\n        }\r\n        view.set(\"range\", [[xMin, xMax], [zMin,zMax], [yMin, yMax]]);\r\n\r\n\r\n        // just a solid blue color\r\n        graphColors.set(\"expr\",\r\n            function (emit, x, y, i, j, t)\r\n            {\r\n                emit( 0, 0.6, 0.9, 0.9 );\r\n            }\r\n        );\r\n\r\n    }\r\n    // end of updateGraph function ==============================================================\r\n\r\n\r\n    var updateGraph = function() { updateGraphFunc(); };\r\n\r\n    // setting proxy:true allows interactive controls to override base position\r\n    var camera = mathbox.camera( { proxy: true, position: [4,2,4] } );\r\n\r\n    // save as variable to adjust later\r\n    view = mathbox.cartesian(\r\n        {\r\n            range: [[xMin, xMax], [yMin, yMax], [zMin,zMax]],\r\n            scale: [2,1,2],\r\n        }\r\n    );\r\n\r\n    // axes\r\n    var xAxis = view.axis( {axis: 1, width: 8, detail: 40, color:\"red\"} );\r\n    var xScale = view.scale( {axis: 1, divide: 10, nice:true, zero:true} );\r\n    var xTicks = view.ticks( {width: 5, size: 15, color: \"red\", zBias:2} );\r\n    var xFormat = view.format( {digits: 2, font:\"Arial\", weight: \"bold\", style: \"normal\", source: xScale} );\r\n    var xTicksLabel = view.label( {color: \"red\", zIndex: 0, offset:[0,-20], points: xScale, text: xFormat} );\r\n\r\n    var yAxis = view.axis( {axis: 3, width: 8, detail: 40, color:\"green\"} );\r\n    var yScale = view.scale( {axis: 3, divide: 5, nice:true, zero:false} );\r\n    var yTicks = view.ticks( {width: 5, size: 15, color: \"green\", zBias:2} );\r\n    var yFormat = view.format( {digits: 2, font:\"Arial\", weight: \"bold\", style: \"normal\", source: yScale} );\r\n    var yTicksLabel = view.label( {color: \"green\", zIndex: 0, offset:[0,0], points: yScale, text: yFormat} );\r\n\r\n    var zAxis = view.axis( {axis: 2, width: 8, detail: 40, color:\"blue\"} );\r\n    var zScale = view.scale( {axis: 2, divide: 5, nice:true, zero:false} );\r\n    var zTicks = view.ticks( {width: 5, size: 15, color: \"blue\", zBias:2} );\r\n    var zFormat = view.format( {digits: 2, font:\"Arial\", weight: \"bold\", style: \"normal\", source: zScale} );\r\n    var zTicksLabel = view.label( {color: \"blue\", zIndex: 0, offset:[0,0], points: zScale, text: zFormat} );\r\n\r\n    view.grid( {axes:[1,3], width: 2, divideX: 20, divideY: 20, opacity:0.25} );\r\n\r\n    var graphData = view.area({\r\n        axes: [1,3], channels: 3, width: resolution, height: resolution,\r\n        expr: function (emit, x, y, i, j, t)\r\n        {\r\n            var z = x*y;\r\n            emit( x, z, y );\r\n        },\r\n    });\r\n\r\n    // actuall emitter set later.\r\n    var graphColors = view.area({\r\n        expr: function (emit, x,y, i,j, t)\r\n        {\r\n            if (x < 0)\r\n                emit(1.0, 0.0, 0.0, 1.0);\r\n            else\r\n                emit(0.0, 1.0, 0.0, 1.0);\r\n        },\r\n        axes: [1,3],\r\n        width:  resolution, height: resolution,\r\n        channels: 4, // RGBA\r\n    });\r\n\r\n    // create graph in two parts, because want solid and wireframe to be different colors\r\n    // shaded:false for a solid color (curve appearance provided by mesh)\r\n    // width: width of line mesh\r\n    // note: colors will mult. against color value, so set color to white (#FFFFFF) to let colors have complete control.\r\n    var graphShaded = false;\r\n    var graphViewSolid = view.surface({\r\n        points:graphData,\r\n        color:\"#FFFFFF\", shaded:false, fill:true, lineX:false, lineY:false, colors:graphColors, visible:true, width:0\r\n    });\r\n\r\n    var graphWireVisible = true;\r\n    var graphViewWire = view.surface({\r\n        points: graphData,\r\n        color:\"#000000\", shaded:false, fill:false, lineX:true, lineY:true, visible:graphWireVisible, width:2\r\n    });\r\n\r\n\r\n    updateGraphFunc();\r\n\r\n}"],"file":"threedradio.min.js"}