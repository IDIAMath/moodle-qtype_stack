define("qtype_stack/threedradio",["exports","./marchingcube"],(function(_exports,_marchingcube){var obj;function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.threedradio=_exports.initMethods=_exports.createGraphColorFunc=_exports.createCanvas=void 0,_marchingcube=(obj=_marchingcube)&&obj.__esModule?obj:{default:obj};var standardValues={backgroundcolor:"white",graphcolorstyle:"lightblue",disableaxes:!1,ranges:"-3;3;-3;3",resolution:64,graphopacity:null,canvaswidth:"80%",canvasheight:null};_exports.threedradio=function(inputid,exp,options){var _options$canvaswidth,_options$canvasheight;if(options=_objectSpread(_objectSpread({},standardValues),options),null==exp||""==exp)return null;exp=exp.slice(6,exp.length-7);var element=document.getElementById(inputid).parentNode;element.style.width=null!==(_options$canvaswidth=options.canvaswidth)&&void 0!==_options$canvaswidth?_options$canvaswidth:"80%",element.style.height=null!==(_options$canvasheight=options.canvasheight)&&void 0!==_options$canvasheight?_options$canvasheight:0,"0px"==element.style.height&&(element.style.paddingBottom="50%"),element.style.margin="10px",element.style.display="inline-flex";!function waitfordependencies(){"undefined"==typeof board||"undefined"==typeof Parser?setTimeout(waitfordependencies,100):createCanvas(element,exp,options)}()};var createMathBox=function(element,expression){var _options$canvaswidth2,_options$canvasheight2,options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};options=_objectSpread(_objectSpread({},standardValues),options),console.log(element);var canvasDiv=document.createElement("div");return canvasDiv.style.width=null!==(_options$canvaswidth2=options.canvaswidth)&&void 0!==_options$canvaswidth2?_options$canvaswidth2:"80%",canvasDiv.style.height=null!==(_options$canvasheight2=options.canvasheight)&&void 0!==_options$canvasheight2?_options$canvasheight2:"0",canvasDiv.style.paddingBottom="50%",canvasDiv.style.margin="10px",canvasDiv.style.display="inline-flex",element.appendChild(canvasDiv),createCanvas(canvasDiv,expression,options)},createCanvas=function(element,expression){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},resolution=(options=_objectSpread(_objectSpread({},standardValues),options)).resolution,disableaxes=options.disableaxes,ranges=options.ranges.split(";").map((function(num){return parseFloat(num)})),xMin=parseFloat(ranges[0]),xMax=parseFloat(ranges[1]),yMin=parseFloat(ranges[2]),yMax=parseFloat(ranges[3]),zMin=-3,zMax=3;ranges.length>4&&(zMin=parseFloat(ranges[4]),zMax=parseFloat(ranges[5]));var board=JXG.JSXGraph.initBoard(divId,{boundingbox:[-5,5,5,-5],keepaspectratio:!1,axis:!1,grid:!0}),box=[-5,-5],view=board.create("view3d",[[-6,-3],[8,8],[box,box,box]],{xPlaneRear:{visible:!1},yPlaneRear:{visible:!1}});if(null!=expression&&""!=expression){var zFunc=Parser.parse(expression).toJSFunction(["x","y"]);if(ranges.length<=4){var _calculateZRange$map=calculateZRange(zFunc,ranges,resolution).map((function(num){return parseFloat(num)})),_calculateZRange$map2=_slicedToArray(_calculateZRange$map,2);zMin=_calculateZRange$map2[0],zMax=_calculateZRange$map2[1]}var _createGraph=createGraph(expression,view,options),_createGraph2=_slicedToArray(_createGraph,2);zMin=_createGraph2[0],zMax=_createGraph2[1]}view.set("range",[[xMin,xMax],[zMin,zMax],[yMin,yMax]]);board.camera({proxy:!0,position:[4,2,4]});if(!disableaxes){view.axis({axis:1,width:8,zIndex:1,detail:40,color:"red"});var xScale=view.scale({axis:1,divide:10,nice:!0,zero:!0}),xFormat=(view.ticks({width:5,size:15,color:"red",zBias:2}),view.format({digits:2,font:"Arial",weight:"bold",style:"normal",source:xScale})),yScale=(view.label({color:"red",zIndex:1,offset:[0,-20],points:xScale,text:xFormat}),view.axis({axis:3,width:8,detail:40,color:"green"}),view.scale({axis:3,divide:5,nice:!0,zero:!1})),yFormat=(view.ticks({width:5,size:15,color:"green",zBias:2}),view.format({digits:2,font:"Arial",weight:"bold",style:"normal",source:yScale})),zScale=(view.label({color:"green",zIndex:1,offset:[0,0],points:yScale,text:yFormat}),view.axis({axis:2,width:8,detail:40,color:"blue"}),view.scale({axis:2,divide:5,nice:!0,zero:!1})),zFormat=(view.ticks({width:5,size:15,color:"blue",zBias:2}),view.format({digits:2,font:"Arial",weight:"bold",style:"normal",source:zScale}));view.label({color:"blue",zIndex:1,offset:[0,0],points:zScale,text:zFormat})}return view.grid({axes:[1,3],width:2,divideX:20,divideY:20,opacity:.25}),options.hasOwnProperty("backgroundcolor")&&board.three.renderer.setClearColor(options.backgroundcolor),[board,view]};_exports.createCanvas=createCanvas;var createGraph=function(exp,view){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((""+exp).includes("=")||(""+exp).includes("z"))return console.log("Implicit graph"),createImplicitGraph(exp,view,options);if((""+exp).includes("u")||(""+exp).includes("v")){console.log("Parametric graph");var _split=(""+exp).split(","),_split2=_slicedToArray(_split,3),x=_split2[0],y=_split2[1],z=_split2[2];return createParametricGraph(x,y,z,view,options)}return console.log("Explicit graph"),createExplicitGraph(exp,view,options)},calculateZRange=function(zFunc,ranges,resolution){for(var _ranges$map2=_slicedToArray(ranges.map((function(num){return parseFloat(num)})),4),xMin=_ranges$map2[0],xMax=_ranges$map2[1],yMin=_ranges$map2[2],yMax=_ranges$map2[3],xStep=(xMax-xMin)/resolution,yStep=(yMax-yMin)/resolution,zSmallest=zFunc(xMin,xMax),zBiggest=zFunc(xMin,yMin),x=xMin;x<=xMax;x+=xStep)for(var y=yMin;y<=yMax;y+=yStep){var z=zFunc(x,y);z<zSmallest&&(zSmallest=z),z>zBiggest&&(zBiggest=z)}return[zSmallest,zBiggest]},createParametricGraph=function(x,y,z,view){var options=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},ranges=(options=_objectSpread(_objectSpread({},standardValues),options)).ranges.split(";").map((function(num){return parseFloat(num)})),resolution=options.resolution,xMin=parseFloat(ranges[0]),xMax=parseFloat(ranges[1]),yMin=parseFloat(ranges[2]),yMax=parseFloat(ranges[3]),zMin=-3,zMax=3,xFunc=Parser.parse(x).toJSFunction(["u","v"]),yFunc=Parser.parse(y).toJSFunction(["u","v"]),zFunc=Parser.parse(z).toJSFunction(["u","v"]);if(ranges<5){var _calculateZRange$map3=calculateZRange(zFunc,ranges,resolution).map((function(num){return parseFloat(num)})),_calculateZRange$map4=_slicedToArray(_calculateZRange$map3,2);zMin=_calculateZRange$map4[0],zMax=_calculateZRange$map4[1]}else{var _ranges$slice=ranges.slice(-2),_ranges$slice2=_slicedToArray(_ranges$slice,2);zMin=_ranges$slice2[0],zMax=_ranges$slice2[1]}var graphColorFunc=createGraphColorFunc(zFunc,zMin,zMax,options),graphData=view.area({axes:[1,3],channels:3,width:resolution,height:resolution,expr:function(emit,u,v,i,j,t){emit(xFunc(u,v),zFunc(u,v),yFunc(u,v))}}),graphColors=view.area({rangeX:[xMin,xMax],rangeY:[yMin,yMax],expr:graphColorFunc,axes:[1,3],width:resolution,height:resolution,channels:4}),graphWireVisible=(view.surface({points:graphData,color:"#FFFFFF",shaded:!1,fill:!0,lineX:!1,lineY:!1,colors:graphColors,visible:!0,width:0}),!0);view.surface({points:graphData,color:"#000000",shaded:!1,fill:!1,lineX:!0,lineY:!0,visible:graphWireVisible,width:1});return[zMin,zMax]},createImplicitGraph=function(exp,view,options){var _ranges$,_ranges$2,_ranges$3,_ranges$4,_ranges$5,_ranges$6,resolution=(options=_objectSpread(_objectSpread({},standardValues),options)).resolution,ranges=options.ranges.split(";").map((function(num){return parseFloat(num)}));ranges.length<5&&(ranges=[null!==(_ranges$=ranges[0])&&void 0!==_ranges$?_ranges$:-3,null!==(_ranges$2=ranges[1])&&void 0!==_ranges$2?_ranges$2:3,null!==(_ranges$3=ranges[2])&&void 0!==_ranges$3?_ranges$3:-3,null!==(_ranges$4=ranges[3])&&void 0!==_ranges$4?_ranges$4:3,null!==(_ranges$5=ranges[4])&&void 0!==_ranges$5?_ranges$5:-3,null!==(_ranges$6=ranges[5])&&void 0!==_ranges$6?_ranges$6:3]);var functions=(""+exp).replace("==","=").split("="),frankenstein=Parser.parse(functions[0])+"-"+Parser.parse(functions[1]),frankenfunc=Parser.parse(frankenstein).toJSFunction(["x","z","y"]);console.log(ranges);for(var implicitTriangles=(0,_marchingcube.default)(ranges[0],ranges[1],ranges[2],ranges[3],ranges[4],ranges[5],frankenfunc,0,resolution),i=1;implicitTriangles.length>5400;)console.log(implicitTriangles.length),implicitTriangles=(0,_marchingcube.default)(ranges[0],ranges[1],ranges[2],ranges[3],ranges[4],ranges[5],frankenfunc,0,resolution/(2*i)),i++;var implicitgroup=view.group({visible:!0});implicitgroup.array({items:3,channels:3,data:implicitTriangles,width:implicitTriangles.length,live:!1}),implicitgroup.strip({zOrder:0,color:"#3090FF",opacity:1,zIndex:0,zBias:0,shaded:!0,fill:!0});return[ranges[4],ranges[5]]},createExplicitGraph=function(exp,view){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},resolution=(options=_objectSpread(_objectSpread({},standardValues),options)).resolution,ranges=options.ranges.split(";").map((function(num){return parseFloat(num)})),functionText=exp,zMin=(parseFloat(ranges[0]),parseFloat(ranges[1]),parseFloat(ranges[2]),parseFloat(ranges[3]),-3),zMax=3,zFunc=Parser.parse(functionText).toJSFunction(["x","y"]);if(ranges.length<5){var _calculateZRange$map5=calculateZRange(zFunc,ranges,resolution).map((function(num){return parseFloat(num)})),_calculateZRange$map6=_slicedToArray(_calculateZRange$map5,2);zMin=_calculateZRange$map6[0],zMax=_calculateZRange$map6[1]}else{var _ranges$slice3=ranges.slice(-2),_ranges$slice4=_slicedToArray(_ranges$slice3,2);zMin=_ranges$slice4[0],zMax=_ranges$slice4[1]}var graphColorFunc=createGraphColorFunc(zFunc,zMin,zMax,options),graphData=view.area({axes:[1,3],channels:3,width:resolution,height:resolution,expr:function(emit,x,y,i,j,t){emit(x,zFunc(x,y),y)}}),graphColors=view.area({expr:graphColorFunc,axes:[1,3],width:resolution,height:resolution,channels:4}),graphWireVisible=(view.surface({points:graphData,color:"#FFFFFF",shaded:!1,fill:!0,lineX:!1,lineY:!1,colors:graphColors,visible:!0,width:0}),!0);view.surface({points:graphData,color:"#000000",shaded:!1,fill:!1,lineX:!0,lineY:!0,visible:graphWireVisible,width:1});return[zMin,zMax]},createGraphColorFunc=function(zFunc,zMin,zMax){var graphColorFunc,options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},graphopacity=options.graphopacity,graphColorStyle=options.graphcolorstyle;return"grayscale"==graphColorStyle?graphColorFunc=function(emit,x,y,i,j,t){var percent=(zFunc(x,y)-zMin)/(zMax-zMin);emit(percent,percent,percent,null!=graphopacity?graphopacity:1)}:"rainbow"==graphColorStyle?graphColorFunc=function(emit,x,y,i,j,t){var percent=(zFunc(x,y)-1.2*zMin)/(zMax-1.2*zMin),color=new THREE.Color(16777215);color.setHSL(1-percent,1,.5),emit(color.r,color.g,color.b,null!=graphopacity?graphopacity:.8)}:"lightblue"==graphColorStyle?graphColorFunc=function(emit,x,y,i,j,t){emit(0,.6,.9,null!=graphopacity?graphopacity:.9)}:"solidblue"==graphColorStyle&&(graphColorFunc=function(emit,x,y,i,j,t){emit(.5,.5,1,null!=graphopacity?graphopacity:1)}),graphColorFunc};_exports.createGraphColorFunc=createGraphColorFunc;_exports.initMethods=function(){var threed={};threed.createParametricGraph=createParametricGraph,threed.createExplicitGraph=createExplicitGraph,threed.createImplicitGraph=createImplicitGraph,threed.createMathbox=createMathBox,threed.createGraph=createGraph,threed.createGraphColorFunc=createGraphColorFunc,window.threed=threed}}));

//# sourceMappingURL=threedradio.min.js.map